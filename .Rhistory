knitr::opts_chunk$set(echo = TRUE, fig.width=9, message = FALSE, warning=FALSE)
library(tidyverse)
library(readxl)
library(lubridate)
library(stringi)
library(pander)
library(janitor)
library(scales)
library(magrittr)
library(kableExtra)
library(viridis)
library(skimr)
library(patchwork)
library(DT)
library(here)
library(sf)
library(googlesheets4)
library(plotly)
library(flextable)
library(snakecase)
library(arabicStemR)
library(writexl)
library(mdepriv)
library(naniar)
theme_set(theme_light())
# disabling scientific notation
options(scipen = 100)
`%out%` <- Negate(`%in%`)
# function for transposing df
transpose_df <- function(df) {
t_df <- data.table::transpose(df)
colnames(t_df) <- rownames(df)
rownames(t_df) <- colnames(df)
t_df <- t_df %>%
tibble::rownames_to_column(.data = .) %>%
tibble::as_tibble(.)
return(t_df)
}
# scaling functions
range01 <- function(x){(x-min(x))/(max(x)-min(x))}
range_wna <- function(x){(x-min(x, na.rm = TRUE))/(max(x, na.rm = TRUE)-min(x, na.rm = TRUE))}
#mode function
mode <- function(x) {
ux <- unique(x)
ux[which.max(tabulate(match(x, ux)))]
}
locations <- read_excel("./data/locations_aoc.csv")
knitr::opts_chunk$set(echo = TRUE, fig.width=9, message = FALSE, warning=FALSE)
library(tidyverse)
library(readxl)
library(lubridate)
library(stringi)
library(pander)
library(janitor)
library(scales)
library(magrittr)
library(kableExtra)
library(viridis)
library(skimr)
library(patchwork)
library(DT)
library(here)
library(sf)
library(googlesheets4)
library(plotly)
library(flextable)
library(snakecase)
library(arabicStemR)
library(writexl)
library(mdepriv)
library(naniar)
theme_set(theme_light())
# disabling scientific notation
options(scipen = 100)
`%out%` <- Negate(`%in%`)
# function for transposing df
transpose_df <- function(df) {
t_df <- data.table::transpose(df)
colnames(t_df) <- rownames(df)
rownames(t_df) <- colnames(df)
t_df <- t_df %>%
tibble::rownames_to_column(.data = .) %>%
tibble::as_tibble(.)
return(t_df)
}
# scaling functions
range01 <- function(x){(x-min(x))/(max(x)-min(x))}
range_wna <- function(x){(x-min(x, na.rm = TRUE))/(max(x, na.rm = TRUE)-min(x, na.rm = TRUE))}
#mode function
mode <- function(x) {
ux <- unique(x)
ux[which.max(tabulate(match(x, ux)))]
}
locations <- read_csv("./data/locations_aoc.csv")
pcode3_shape <-
st_read("./data/syr_admbnda_uncs_unocha_20201217/syr_admbnda_adm3_uncs_unocha_20201217.shp")
knitr::opts_chunk$set(echo = TRUE, fig.width=9, message = FALSE, warning=FALSE)
library(tidyverse)
library(readxl)
library(lubridate)
library(stringi)
library(janitor)
library(scales)
library(magrittr)
library(viridis)
library(skimr)
library(patchwork)
library(DT)
library(here)
library(sf)
library(plotly)
library(flextable)
theme_set(theme_light())
# disabling scientific notation
options(scipen = 100)
`%out%` <- Negate(`%in%`)
# function for transposing df
transpose_df <- function(df) {
t_df <- data.table::transpose(df)
colnames(t_df) <- rownames(df)
rownames(t_df) <- colnames(df)
t_df <- t_df %>%
tibble::rownames_to_column(.data = .) %>%
tibble::as_tibble(.)
return(t_df)
}
# scaling functions
range01 <- function(x){(x-min(x))/(max(x)-min(x))}
range_wna <- function(x){(x-min(x, na.rm = TRUE))/(max(x, na.rm = TRUE)-min(x, na.rm = TRUE))}
#mode function
mode <- function(x) {
ux <- unique(x)
ux[which.max(tabulate(match(x, ux)))]
}
locations <- read_csv("./data/locations_aoc.csv")
pcode3_shape <-
st_read("./data/syr_admbnda_uncs_unocha_20201217/syr_admbnda_adm3_uncs_unocha_20201217.shp")
read_excel("./data/pdm_raw/BHA_COMRES II_CARE_422_Cash_One_off_MPCA PDM For Faris-Shafak.xlsx",
skip = 1) %>%
clean_names()
read_excel("./data/pdm_raw/BHA_COMRES II_CARE_422_Cash_One_off_MPCA PDM For Faris-Shafak.xlsx") %>%
clean_names()
shafak_care <- read_excel("./data/pdm_raw/BHA_COMRES II_CARE_422_Cash_One_off_MPCA PDM For Faris-Shafak.xlsx") %>%
clean_names()
shafak_care %>% glimpse()
shafak_care %>% count(distribution_modality)
shafak_care %>% glimpse()
shafak_care %>% count(implementing_partner_name)
shafak_care %>% glimpse()
skim(shafak_care)
skimr::skim(shafak_care)
shafak_care %>% glimpse()
shafak_care %>% glimpse()
shafak_care %>%
rename(governorate = distribution_location_governorate,
district = distribution_location_district,
sub_district = distribution_location_sub_district,
community = distribution_location_town,
delivery_modality = distribution_modality) %>%
count(community, location_name)
shafak_care <- read_excel("./data/pdm_raw/BHA_COMRES II_CARE_422_Cash_One_off_MPCA PDM For Faris-Shafak.xlsx") %>%
clean_names() %>%
rename(governorate = distribution_location_governorate,
district = distribution_location_district,
sub_district = distribution_location_sub_district,
community = distribution_location_town,
delivery_modality = distribution_modality,
site = location_name)
shafak_care %>%
summarise_at(vars(voucher_kind:distrebuted_voucher_type_winterization_items_voucher),
~ sum(.))
shafak_care %>%
summarise_at(vars(voucher_kind:distrebuted_voucher_type_winterization_items_voucher),
~ sum(., na.rm = TRUE))
shafak_care %>% glimpse()
shafak_care %>%
summarise_at(
vars(distrebuted_voucher_type_multi_purpose_voucher_one_off:
distrebuted_voucher_type_winterization_items_voucher),
~ sum(., na.rm = TRUE))
shafak_care %>% count(distrebuted_voucher_type )
shafak_care %>% count(are_there_any_people_with_disabilities_in_your_household)
shafak_care %>% glimpse()
shafak_care %>% select(contains("satisfied"))
shafak_care %>% count(are_you_satisfied_with_the_type_of_assistance_you_received)
shafak_care %>%
select(where(not_all_na)) %>%
glimpse()
not_all_na <- function(x) any(!is.na(x))
not_any_na <- function(x) all(!is.na(x))
shafak_care %>%
select(where(not_all_na)) %>%
glimpse()
shafak_care %>% glimpse()
shafak_care %>%
select(where(not_all_na)) %>%
glimpse()
shafak_care <- read_excel("./data/pdm_raw/BHA_COMRES II_CARE_422_Cash_One_off_MPCA PDM For Faris-Shafak.xlsx") %>%
select(where(not_all_na)) %>%
clean_names() %>%
rename(governorate = distribution_location_governorate,
district = distribution_location_district,
sub_district = distribution_location_sub_district,
community = distribution_location_town,
delivery_modality = distribution_modality,
site = location_name,
# Check if there is something like this in other forms
voucher_type = distrebuted_voucher_type,
hh_size = total_number_of_hh_members,
# levels should "No" and "Yes"
pwds_in_hh = are_there_any_people_with_disabilities_in_your_household)
shafak_care %>% count(did_you_face_any_challenges_while_redeeming_the_vouchers)
shafak_care %>%
pivot_longer(cols =
c(on_what_did_your_household_spend_use_the_cash_received_from_the_vouchers,
on_what_did_your_household_spend_use_the_cash_received_from_the_vouchers_100,
on_what_did_your_household_spend_use_the_cash_received_from_the_vouchers_101).
shafak_care %>%
pivot_longer(cols =
c(on_what_did_your_household_spend_use_the_cash_received_from_the_vouchers,
on_what_did_your_household_spend_use_the_cash_received_from_the_vouchers_100,
on_what_did_your_household_spend_use_the_cash_received_from_the_vouchers_101),
names_to = "item_cat",
values_to = "items_bought") %>%
count(items_bought)
shafak_care %>%
glimpse()
shafak_care %>% count(distrebuted_voucher_type_multi_rounds_voucher)
shafak_care %>% count(what_are_your_households_three_most_urgent_and_important_needs_that_are_not_currently_met)
shafak_care <- read_excel("./data/pdm_raw/BHA_COMRES II_CARE_422_Cash_One_off_MPCA PDM For Faris-Shafak.xlsx") %>%
select(where(not_all_na)) %>%
clean_names() %>%
rename(governorate = distribution_location_governorate,
district = distribution_location_district,
sub_district = distribution_location_sub_district,
community = distribution_location_town,
delivery_modality = distribution_modality,
site = location_name,
# Check if there is something like this in other forms
voucher_type = distrebuted_voucher_type,
hh_size = total_number_of_hh_members,
# levels should "No" and "Yes"
pwds_in_hh = are_there_any_people_with_disabilities_in_your_household,
# store them like this, add a fourth and fifth column if it helps with the rbind()
# But in the analysis, you'll need to pivot_longer()
# As a further note, the options do not match with the harmonised tool,
# so after pivoting, you will still need to clean this column
items_bought1 = on_what_did_your_household_spend_use_the_cash_received_from_the_vouchers,
items_bought2 = on_what_did_your_household_spend_use_the_cash_received_from_the_vouchers_100,
items_bought3 = on_what_did_your_household_spend_use_the_cash_received_from_the_vouchers_101,
unmet_needs = what_are_your_households_three_most_urgent_and_important_needs_that_are_not_currently_met)
shafak_care %>% count(unmet_needs)
shafak_care %>%
mutate(unmet_needs = str_replace_all(unmet_needs, "Shelter/Housing", "Shelter")) %>%
count(unmet_needs)
shafak_care %>%
mutate(unmet_needs = str_replace_all(unmet_needs, "Shelter/Housing", "Shelter"),
unmet_needs = unlist(strsplit(unmet_needs, "\\s+(?=C)", perl=TRUE)))
shafak_care %>%
mutate(unmet_needs = str_replace_all(unmet_needs, "Shelter/Housing", "Shelter"),
unmet_needs = (strsplit(unmet_needs, "\\s+(?=C)", perl=TRUE)))
shafak_care %>%
mutate(unmet_needs = str_replace_all(unmet_needs, "Shelter/Housing", "Shelter"),
unmet_needs = (strsplit(unmet_needs, "\\s+(?=C)", perl=TRUE))) %>%
unlist(unmet_needs)
shafak_care %>%
mutate(unmet_needs = str_replace_all(unmet_needs, "Shelter/Housing", "Shelter"),
unmet_needs = (strsplit(unmet_needs, "\\s+(?=C)", perl=TRUE)))
shafak_care %>%
mutate(unmet_needs = str_replace_all(unmet_needs, "Shelter/Housing", "Shelter"),
unmet_needs = (strsplit(unmet_needs, "\\s+(?=C)", perl=TRUE))) %>%
select(unmet_needs) %>%
unlist()
shafak_care %>%
mutate(unmet_needs = str_replace_all(unmet_needs, "Shelter/Housing", "Shelter"),
unmet_needs = str_replace_all(
unmet_needs,
pattern = "([[:upper:]])",
replacement = " \\1,"
)) %>%
select(unmet_needs)
shafak_care %>%
mutate(unmet_needs = str_replace_all(unmet_needs, "Shelter/Housing", "Shelter"),
unmet_needs = str_replace_all(
unmet_needs,
pattern = "([[:upper:]])",
replacement = " ,\\1"
)) %>%
select(unmet_needs)
shafak_care %>%
mutate(unmet_needs = str_replace_all(unmet_needs, "Shelter/Housing", "Shelter"),
unmet_needs = str_replace_all(
unmet_needs,
pattern = "([[:upper:]])",
replacement = ", \\1"
)) %>%
select(unmet_needs)
shafak_care %>%
mutate(unmet_needs = str_replace_all(unmet_needs, "Shelter/Housing", "Shelter"),
unmet_needs = str_replace_all(
unmet_needs,
pattern = "([[:upper:]])",
replacement = ", \\1"),
unmet_needs = str_sub(unmet_needs, start = 3L, end = -1L)) %>%
select(unmet_needs)
shafak_care %>%
mutate(unmet_needs = str_replace_all(unmet_needs, "Shelter/Housing", "Shelter"),
unmet_needs = str_replace_all(
unmet_needs,
pattern = "([[:upper:]])",
replacement = ", \\1"),
unmet_needs = str_trim(str_sub(unmet_needs, start = 3L, end = -1L))) %>%
select(unmet_needs)
shafak_care %>%
%>% mutate(unmet_needs = str_replace_all(unmet_needs, "Shelter/Housing", "Shelter"),
shafak_care %>%
mutate(unmet_needs = str_replace_all(unmet_needs, "Shelter/Housing", "Shelter"),
unmet_needs = str_replace_all(
unmet_needs,
pattern = "([[:upper:]])",
replacement = ", \\1"),
unmet_needs = trimws(str_sub(unmet_needs, start = 3L, end = -1L))) %>%
select(unmet_needs)
shafak_care %>% select(contains("currency"))
shafak_care %>%
glimpse()
shafak_care %>% count(do_you_think_the_assistance_you_received_were_in_line_with_your_needs )
shafak_care %>% count(were_you_satisfied_with_the_redemption_process)
shafak_care %>% count(why_60)
shafak_care %>% count(were_you_satisfied_with_the_redemption_process)
shafak_care %>% count(if_yes_what_were_those_difficulties)
